<script type="text/javascript">
  window.actualizarGrafico = function(bpm, fechas) {
    const datosBPM = bpm.split(',').map(Number);
    const etiquetas = fechas.split(',');

    const ctx = document.getElementById('miGrafica').getContext('2d');

    // Si ya existe un gráfico, lo destruimos para evitar superposición
    if (window.miGrafico) {
      window.miGrafico.destroy();
    }

    // Creamos un nuevo gráfico con los datos recibidos
    window.miGrafico = new Chart(ctx, {
      type: 'line',
      data: {
        labels: etiquetas,
        datasets: [{
          label: 'Frecuencia cardíaca (BPM)',
          data: datosBPM,
          borderColor: 'blue',
          borderWidth: 2,
          fill: false,
          pointRadius: 4,
          pointHoverRadius: 6
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: false
          }
        }
      }
    });
  };
</script>
